{% extends 'settingsBase.html' %}

{% block css %}
		<style type="text/css">
			.all {
				width: 100%;
				height: 100%;
				padding-bottom: 100px;
			}
			.banner{
				float: left;
				width: 100%;
				text-align: center;
			}
			.rest{
				float: left;
				width: 100%;
			}
			#user_type{
				background-color: white;
				padding: 12px;
			}
			.left {
				float: left;
				width: 50%;
				height: 65%;
				text-align: center;
			}
			.right {
				float: left;
				width: 50%;
				height: 65%;
				text-align: center;
			}
			.form-control-left {
				margin-top: 2.65%;
				width: 60%;
				text-align: center;
				float: right;
				margin-right: 15%;
			}
			.form-control-right {
				width: 60%;
				text-align: center;
				float: left;
				margin-top: 1%;
				margin-left: 15%;
			}
			.btn {
				width: 30%;
				margin-left: 35%;
				margin-right: 35%;
				margin-bottom: 100px;
			}
		</style>
{% endblock css %}

{% block content %}
						<div class="all">
							<div class="banner">
								<form method="POST">
								{% csrf_token %}
								<select name="user_type" id="user_type" style="display: inline-block; float: right;">
									<option value="admin">Admin</option>
									<option value="employee">Employee</option>
									<option value="client">Client</option>
								</select>
								<h1 style="display: inline-block;">Add User</h1>
							</div>
							<div class="left">
								{% for userinput in UserForm %}
									{{ userinput }}
								{% endfor %}
							</div>
							<div class="right">
								<input type="text" name="birth_date" placeholder="birth date" class="form-control form-control-right" onfocus="(this.type=&#x27;date&#x27;)" min="01.01.1900" max="31.12.2020" required id="id_birth_date">
								<input type="text" name="pesel" placeholder="pesel" class="form-control form-control-right" maxlength="11" minlength="11" required id="id_pesel">
								<input type="text" name="id_number" placeholder="id number" class="form-control form-control-right" maxlength="7" minlength="7" required id="id_id_number">
								<input type="text" name="city" placeholder="city" class="form-control form-control-right" required id="id_city">
								<input type="text" name="street" placeholder="street" class="form-control form-control-right" required id="id_street">
								<input type="text" name="street_number" placeholder="street number" class="form-control form-control-right" maxlength="5" required id="id_street_number">
								<input type="text" name="postal_code" placeholder="postal code" class="form-control form-control-right" maxlength="6" minlength="6" required id="id_postal_code">
							</div>
							<button class="btn btn-lg btn-primary btn-block" type="submit" disabled="True" id="subbut">Add</button>
							</form>
						</div>
{% endblock content %}

{% block js %}
	<script type="text/javascript">
		$('#id_password1, #id_password2, #id_postal_code, #id_id_number, #id_pesel').keyup(function(){
			const passCheck = () => {
				const pass1 = document.getElementById('id_password1').value;
				const pass2 = document.getElementById('id_password2').value;
				
				const regex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/gm;

				const regexCheck = regex.test(pass1);
				if(pass1 == pass2 && regexCheck){
					return true;
				}
			}
			const postalCheck = () => {
				const postal = document.getElementById('id_postal_code').value;

				const regex = /[0-9]{2}\-[0-9]{3}/gm;

				if(regex.test(postal)){
					return true
				}
			}
			const id_numberCheck = () => {
				const id_number = document.getElementById('id_id_number').value;

				const regex = /[A-Z]{3}\ [0-9]{3}/gm;

				if(regex.test(id_number)){
					return true
				}
			}
			const peselCheck = () => {
				const pesel = document.getElementById('id_pesel').value;

				const regex = /[0-9]{11}/gm;

				if(regex.test(pesel)){
					return true
				}
			}
			if(passCheck() && postalCheck() && id_numberCheck() && peselCheck()){
				$('#subbut').prop('disabled', false);
			}
		})
	</script>
{% endblock js %}