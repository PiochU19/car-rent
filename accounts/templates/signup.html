{% extends 'base.html' %}

{% load static %}

{% block css %}
		<link rel="stylesheet" href="{% static 'css/form.css' %}">

		<style>
			.baner {
				background-color: transparent;
				float: left;
				width: 100%;
				margin-top: 3%;
				height: 12%;
				text-align: center;
			}
			.left {
				float: left;
				width: 50%;
				height: 65%;
				text-align: center;
			}
			.right {
				float: left;
				width: 50%;
				height: 65%;
				text-align: center;
			}
			.submitdiv {
				clear: both;
				float: left;
				width: 100%;
				height: 18%;
			}
			.form-control-left {
				margin-top: 2.1%;
				width: 40%;
				text-align: center;
				float: right;
				margin-right: 15%;
			}
			.form-control-right {
				width: 40%;
				text-align: center;
				float: left;
				margin-top: 1.05%;
				margin-left: 15%;
			}
			.submitdiv {
				text-align: center;
			}
			.btn {
				width: 30%;
				margin-left: 35%;
				margin-right: 35%;
			}
		</style>
{% endblock css %}

{% block content %}
			<div class="baner">
				<h1 class="h1 mb-3">Sign up</h1>
			</div>
			<div class="left">
				<form method="post">
				{% csrf_token %}
					{% for userinput in UserForm %}
						{{ userinput }}
					{% endfor %}
			</div>
			<div class="right">
					{% for clientinput in ClientForm %}
						{{ clientinput }}
					{% endfor %}
			</div>
			<div class="submitdiv">
					<p>Already 	have an account? <a href="{% url 'login' %}">Log in</a></p>
      				<button class="btn btn-lg btn-primary btn-block" type="submit" disabled="True" id="subbut">Sign up</button>
				</form>
			</div>
{% endblock content %}

{% block js %}
	<script type="text/javascript">
		$('#id_password1, #id_password2, #id_postal_code, #id_id_number, #id_pesel').keyup(function(){
			const passCheck = () => {
				const pass1 = document.getElementById('id_password1').value;
				const pass2 = document.getElementById('id_password2').value;
				
				const regex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/gm;

				const regexCheck = regex.test(pass1);
				if(pass1 == pass2 && regexCheck){
					return true;
				}
			}
			const postalCheck = () => {
				const postal = document.getElementById('id_postal_code').value;

				const regex = /[0-9]{2}\-[0-9]{3}/gm;

				if(regex.test(postal)){
					return true
				}
			}
			const id_numberCheck = () => {
				const id_number = document.getElementById('id_id_number').value;

				const regex = /[A-Z]{3}\ [0-9]{3}/gm;

				if(regex.test(id_number)){
					return true
				}
			}
			const peselCheck = () => {
				const pesel = document.getElementById('id_pesel').value;

				const regex = /[0-9]{11}/gm;

				if(regex.test(pesel)){
					return true
				}
			}
			if(passCheck() && postalCheck() && id_numberCheck() && peselCheck()){
				$('#subbut').prop('disabled', false);
			}
		})
	</script>
{% endblock js %}